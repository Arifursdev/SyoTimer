/**
 * SyoTimer v.2.0.0-alpha | under MIT licence
 * https://github.com/mrfratello/SyoTimer#readme
 */
!function(e){var t="day",i="hour",n="minute",r="second",o=86400,a=3600,s=60,l={d:t,h:i,m:n,s:r},d={list:[r,n,i,t],next:function(e){var t=this.list.indexOf(e);return t<this.list.length&&this.list[t+1]},prev:function(e){var t=this.list.indexOf(e);return t>0&&this.list[t-1]}},m={year:2014,month:7,day:31,hour:0,minute:0,second:0,timeZone:"local",ignoreTransferTime:!1,layout:"dhms",periodic:!1,periodInterval:7,periodUnit:"d",doubleNumbers:!0,effectType:"none",lang:"eng",headTitle:"",footTitle:"",afterDeadline:function(e){e.bodyBlock.html('<p style="font-size: 1.2em;">The countdown is finished!</p>')}},c={second:!1,minute:!1,hour:!1,day:!1},u={init:function(t){var i=e.extend({},m,t||{});i.itemTypes=y.getItemTypesByLayout(i.layout),i._itemsHas=e.extend({},c);for(var n=0;n<i.itemTypes.length;n++)i._itemsHas[i.itemTypes[n]]=!0;return this.each(function(){var t=e(this);t.data("syotimer-options",i),u._render.apply(this,[]),u._perSecondHandler.apply(this,[])})},_render:function(){for(var t=e(this),i=t.data("syotimer-options"),n=y.getTimerItem(),r=e("<div/>",{"class":"syotimer__head"}).html(i.headTitle),o=e("<div/>",{"class":"syotimer__body"}),a=e("<div/>",{"class":"syotimer__footer"}).html(i.footTitle),s={},l=0;l<i.itemTypes.length;l++){var d=n.clone();d.addClass("syotimer-cell_type_"+i.itemTypes[l]),o.append(d),s[i.itemTypes[l]]=d}var m={headBlock:r,bodyBlock:o,footBlock:a};t.data("syotimer-blocks",m).data("syotimer-items",s).addClass("syotimer").append(r).append(o).append(a)},_perSecondHandler:function(){var t=e(this),i=t.data("syotimer-options");e(".syotimer-cell > .syotimer-cell__value",t).css("opacity",1);var n=new Date,r=new Date(i.year,i.month-1,i.day,i.hour,i.minute,i.second),o=y.getDifferenceWithTimezone(n,r,i),a=y.getSecondsToDeadLine(o,i);a>=0?(u._refreshUnitsDom.apply(this,[a]),u._applyEffectSwitch.apply(this,[i.effectType])):(t=e.extend(t,t.data("syotimer-blocks")),i.afterDeadline(t))},_refreshUnitsDom:function(i){var n=e(this),r=n.data("syotimer-options"),o=n.data("syotimer-items"),a=r.itemTypes,s=y.getUnitsToDeadLine(i);r._itemsHas.day||(s.hour+=24*s.day),r._itemsHas.hour||(s.minute+=60*s.hour),r._itemsHas.minute||(s.second+=60*s.minute);for(var l=0;l<a.length;l++){var d=a[l],m=s[d],c=o[d];c.data("syotimer-unit-value",m),e(".syotimer-cell__value",c).html(y.format2(m,d!==t&&r.doubleNumbers)),e(".syotimer-cell__unit",c).html(e.syotimerLang.getNumeral(m,r.lang,d))}},_applyEffectSwitch:function(t,i){i=i||r;var n=this,o=e(n);if("none"===t)setTimeout(function(){u._perSecondHandler.apply(n,[])},1e3);else if("opacity"===t){var a=o.data("syotimer-items"),s=a[i];if(s){var l=d.next(i),m=s.data("syotimer-unit-value");e(".syotimer-cell__value",s).animate({opacity:.1},1e3,"linear",function(){u._perSecondHandler.apply(n,[])}),l&&0===m&&u._applyEffectSwitch.apply(n,[t,l])}}}},y={getTimerItem:function(){var t=e("<div/>",{"class":"syotimer-cell__value",text:"0"}),i=e("<div/>",{"class":"syotimer-cell__unit"}),n=e("<div/>",{"class":"syotimer-cell"});return n.append(t).append(i),n},getItemTypesByLayout:function(e){for(var t=[],i=0;i<e.length;i++)t.push(l[e[i]]);return t},getSecondsToDeadLine:function(e,t){var i,n=e/1e3;if(n=Math.floor(n),t.periodic){var r,o,a=y.getPeriodUnit(t.periodUnit),s=e/(1e3*a);s=Math.ceil(s),s=Math.abs(s),n>=0?(o=s%t.periodInterval,o=0===o?t.periodInterval:o,o-=1):o=t.periodInterval-s%t.periodInterval,r=n%a,0===r&&n<0&&o--,i=Math.abs(o*a+r)}else i=n;return i},getUnitsToDeadLine:function(e){var i=t,n={};do{var r=y.getPeriodUnit(i);n[i]=Math.floor(e/r),e%=r}while(i=d.prev(i));return n},getPeriodUnit:function(e){switch(e){case"d":case t:return o;case"h":case i:return a;case"m":case n:return s;case"s":case r:return 1}},getDifferenceWithTimezone:function(e,t,r){var o,a=t.getTime()-e.getTime(),s=0,l=0;if("local"!==r.timeZone){var d=parseFloat(r.timeZone)*y.getPeriodUnit(i),m=-e.getTimezoneOffset()*y.getPeriodUnit(n);s=1e3*(d-m)}if(r.ignoreTransferTime){var c=-e.getTimezoneOffset()*y.getPeriodUnit(n),u=-t.getTimezoneOffset()*y.getPeriodUnit(n);l=1e3*(c-u)}return o=s+l,a-o},format2:function(e,t){return t=t!==!1,e<=9&&t?"0"+e:""+e}},p={setOption:function(t,i){var n=e(this),r=n.data("syotimer-options");r.hasOwnProperty(t)&&(r[t]=i,n.data("syotimer-options",r))}};e.fn.syotimer=function(t){if("string"==typeof t&&"setOption"===t){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){p[t].apply(this,i)})}return null===t||"object"==typeof t?u.init.apply(this,[t]):void e.error("SyoTimer. Error in call methods: methods is not exist")},e.syotimerLang={rus:{second:["секунда","секунды","секунд"],minute:["минута","минуты","минут"],hour:["час","часа","часов"],day:["день","дня","дней"],handler:"rusNumeral"},eng:{second:["second","seconds"],minute:["minute","minutes"],hour:["hour","hours"],day:["day","days"]},universal:function(e){return 1===e?0:1},rusNumeral:function(e){var t,i=[2,0,1,1,1,2];return t=e%100>4&&e%100<20?2:i[e%10<5?e%10:5]},getNumeral:function(t,i,n){var r=e.syotimerLang[i].handler||"universal",o=this[r](t);return e.syotimerLang[i][n][o]}}}(jQuery);
//# sourceMappingURL=jquery.syotimer.min.js.map
